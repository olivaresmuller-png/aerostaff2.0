import{c as ye,b as js,r as m,R as qs,F as Vs,J as ys,j as e,G as Ws,H as bs,K as Js,d as T,u as Xs,f as ne,m as Qs,P as He,B as A,A as Ks,y as cs,E as Ys,x as z,V as U,U as os,T as us,W as De,Y as le,Z as de,D as Pe,n as ms,p as _e,q as Oe,v as Le,_ as Fe,$ as xs,X as Ce,I as fe,L as Gs}from"./index-CbnIlcx2.js";import{L as O,B as p}from"./label-DGY_y_Da.js";import{T as Zs,a as et,b as pe,i as ge,P as st,c as ze,d as Ue,e as oe,f as R,g as qe,h as k}from"./table-PEmnfhX0.js";import{i as tt,C as hs,S as J,a as X,f as Q,b as K,e as I}from"./select-DmSMcCjy.js";import{P as Ve,T as fs,C as We}from"./checkbox-xZT3-rQs.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],it=ye("arrow-right-left",at);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ps=ye("clipboard-list",rt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],lt=ye("hard-drive",nt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ct=ye("play",dt);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ut=ye("refresh-cw",ot);function mt(l,d){return js(l,-1)}function xt(l,d,{checkForDefaultPrevented:u=!0}={}){return function(N){if(l?.(N),u===!1||!N.defaultPrevented)return d?.(N)}}var ht=qs[" useInsertionEffect ".trim().toString()]||Vs;function ft({prop:l,defaultProp:d,onChange:u=()=>{},caller:v}){const[N,$,C]=pt({defaultProp:d,onChange:u}),S=l!==void 0,g=S?l:N;{const w=m.useRef(l!==void 0);m.useEffect(()=>{const H=w.current;H!==S&&console.warn(`${v} is changing from ${H?"controlled":"uncontrolled"} to ${S?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),w.current=S},[S,v])}const G=m.useCallback(w=>{if(S){const H=gt(w)?w(l):w;H!==l&&C.current?.(H)}else $(w)},[S,l,$,C]);return[g,G]}function pt({defaultProp:l,onChange:d}){const[u,v]=m.useState(l),N=m.useRef(u),$=m.useRef(d);return ht(()=>{$.current=d},[d]),m.useEffect(()=>{N.current!==u&&($.current?.(u),N.current=u)},[u,N]),[u,v,$]}function gt(l){return typeof l=="function"}var Ie="Switch",[jt]=Ws(Ie),[yt,bt]=jt(Ie),vs=m.forwardRef((l,d)=>{const{__scopeSwitch:u,name:v,checked:N,defaultChecked:$,required:C,disabled:S,value:g="on",onCheckedChange:G,form:w,...H}=l,[D,B]=m.useState(null),Z=ys(d,ie=>B(ie)),L=m.useRef(!1),be=D?w||!!D.closest("form"):!0,[ae,ve]=ft({prop:N,defaultProp:$??!1,onChange:G,caller:Ie});return e.jsxs(yt,{scope:u,checked:ae,disabled:S,children:[e.jsx(bs.button,{type:"button",role:"switch","aria-checked":ae,"aria-required":C,"data-state":Cs(ae),"data-disabled":S?"":void 0,disabled:S,value:g,...H,ref:Z,onClick:xt(l.onClick,ie=>{ve(Te=>!Te),be&&(L.current=ie.isPropagationStopped(),L.current||ie.stopPropagation())})}),be&&e.jsx(ws,{control:D,bubbles:!L.current,name:v,value:g,checked:ae,required:C,disabled:S,form:w,style:{transform:"translateX(-100%)"}})]})});vs.displayName=Ie;var Ns="SwitchThumb",As=m.forwardRef((l,d)=>{const{__scopeSwitch:u,...v}=l,N=bt(Ns,u);return e.jsx(bs.span,{"data-state":Cs(N.checked),"data-disabled":N.disabled?"":void 0,...v,ref:d})});As.displayName=Ns;var vt="SwitchBubbleInput",ws=m.forwardRef(({__scopeSwitch:l,control:d,checked:u,bubbles:v=!0,...N},$)=>{const C=m.useRef(null),S=ys(C,$),g=tt(u),G=Js(d);return m.useEffect(()=>{const w=C.current;if(!w)return;const H=window.HTMLInputElement.prototype,B=Object.getOwnPropertyDescriptor(H,"checked").set;if(g!==u&&B){const Z=new Event("click",{bubbles:v});B.call(w,u),w.dispatchEvent(Z)}},[g,u,v]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:u,...N,tabIndex:-1,ref:S,style:{...N.style,...G,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ws.displayName=vt;function Cs(l){return l?"checked":"unchecked"}var Rs=vs,Nt=As;const ks=m.forwardRef(({className:l,...d},u)=>e.jsx(Rs,{className:T("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...d,ref:u,children:e.jsx(Nt,{className:T("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ks.displayName=Rs.displayName;const At=1,wt=1e6;let Je=0;function Ct(){return Je=(Je+1)%Number.MAX_SAFE_INTEGER,Je.toString()}const Xe=new Map,gs=l=>{if(Xe.has(l))return;const d=setTimeout(()=>{Xe.delete(l),je({type:"REMOVE_TOAST",toastId:l})},wt);Xe.set(l,d)},Rt=(l,d)=>{switch(d.type){case"ADD_TOAST":return{...l,toasts:[d.toast,...l.toasts].slice(0,At)};case"UPDATE_TOAST":return{...l,toasts:l.toasts.map(u=>u.id===d.toast.id?{...u,...d.toast}:u)};case"DISMISS_TOAST":{const{toastId:u}=d;return u?gs(u):l.toasts.forEach(v=>{gs(v.id)}),{...l,toasts:l.toasts.map(v=>v.id===u||u===void 0?{...v,open:!1}:v)}}case"REMOVE_TOAST":return d.toastId===void 0?{...l,toasts:[]}:{...l,toasts:l.toasts.filter(u=>u.id!==d.toastId)}}},ke=[];let Se={toasts:[]};function je(l){Se=Rt(Se,l),ke.forEach(d=>{d(Se)})}function kt({...l}){const d=Ct(),u=N=>je({type:"UPDATE_TOAST",toast:{...N,id:d}}),v=()=>je({type:"DISMISS_TOAST",toastId:d});return je({type:"ADD_TOAST",toast:{...l,id:d,open:!0,onOpenChange:N=>{N||v()}}}),{id:d,dismiss:v,update:u}}function St(){const[l,d]=m.useState(Se);return m.useEffect(()=>(ke.push(d),()=>{const u=ke.indexOf(d);u>-1&&ke.splice(u,1)}),[l]),{...l,toast:kt,dismiss:u=>je({type:"DISMISS_TOAST",toastId:u})}}const It=["FUEL TANK","Walliclean","Forklift","CYCLEAN","Cobra","Cee Bee"],q={"FUEL TANK":{label:"Fuel Tank Entry",color:"bg-amber-500"},Walliclean:{label:"Walliclean",color:"bg-cyan-500"},Forklift:{label:"Forklift",color:"bg-orange-500"},CYCLEAN:{label:"Cyclean",color:"bg-teal-500"},Cobra:{label:"Cobra",color:"bg-red-500"},"Cee Bee":{label:"Cee-Bee",color:"bg-indigo-500"}},Tt=8,Qe=l=>l<=0?0:Math.ceil(l/Tt),Y={urgent:{label:"Urgent",color:"bg-red-500",order:0},high:{label:"High",color:"bg-orange-500",order:1},normal:{label:"Normal",color:"bg-blue-500",order:2},low:{label:"Low",color:"bg-gray-500",order:3}},Bt=[{id:"a1",registration:"HB-JCC",type:"A320 CF",company:"LX"},{id:"a2",registration:"HB-JDA",type:"A320 NEO",company:"LX"},{id:"a3",registration:"HB-JHC",type:"A330 RR",company:"LX"},{id:"a4",registration:"HB-JMC",type:"A343",company:"LX"},{id:"a5",registration:"HB-JCA",type:"A350",company:"LX"},{id:"a6",registration:"HB-JNE",type:"B777",company:"LX"},{id:"a7",registration:"HB-JNF",type:"B777",company:"LX"},{id:"a8",registration:"HB-JBA",type:"A220",company:"LX"}],Re=(l,d)=>{try{const u=localStorage.getItem(l);return u?JSON.parse(u):d}catch{return d}},Mt=l=>l.map(d=>({...d,type:d.type==="777"?"B777":d.type}));function Ot(){const{toast:l}=St(),{employees:d,assignments:u,selectedDate:v,getAssignment:N}=Xs(),$=m.useMemo(()=>d.filter(s=>s.role!=="PM"&&s.role!=="PS"),[d]),[C,S]=m.useState(v),[g,G]=m.useState(()=>Mt(Re("aerostaff_aircraft",Bt))),[w,H]=m.useState(()=>Re("aerostaff_duty",[])),[D,B]=m.useState(()=>Re("aerostaff_requirements",[])),[Z,L]=m.useState(()=>Re("aerostaff_assignments",[])),[be,ae]=m.useState("assignments"),[ve,ie]=m.useState(""),[Te,Ke]=m.useState(!1),[re,Ye]=m.useState(""),[ce,Ge]=m.useState(""),[ue,Ss]=m.useState("B1"),[Is,Ze]=m.useState(!1),[Ne,es]=m.useState(""),[ss,Ts]=m.useState("A320 CF"),[ts,Bs]=m.useState("LX"),[ee,Ae]=m.useState(null),f=ne(C,"yyyy-MM-dd");m.useEffect(()=>{localStorage.setItem("aerostaff_aircraft",JSON.stringify(g))},[g]),m.useEffect(()=>{localStorage.setItem("aerostaff_duty",JSON.stringify(w))},[w]),m.useEffect(()=>{localStorage.setItem("aerostaff_requirements",JSON.stringify(D))},[D]),m.useEffect(()=>{localStorage.setItem("aerostaff_assignments",JSON.stringify(Z))},[Z]);const me=m.useMemo(()=>u.filter(s=>s.date===f).map(s=>({employeeId:s.employeeId,onDuty:Qs(s.shiftCode),shiftCode:s.shiftCode})),[u,f]);m.useEffect(()=>{if(w.filter(t=>t.date===f).length===0){const t=d.map(a=>{const r=me.find(n=>n.employeeId===a.id);return{date:f,employeeId:a.id,onDuty:r?.onDuty??!0}});H(a=>[...a,...t])}},[f,d,me]);const Be=m.useMemo(()=>w.filter(s=>s.date===f),[w,f]),V=m.useMemo(()=>D.filter(s=>s.date===f),[D,f]),M=m.useMemo(()=>Z.filter(s=>s.date===f),[Z,f]);m.useMemo(()=>{const s={};return M.forEach(t=>{const a=g.find(r=>r.id===t.aircraftId);a&&(s[t.employeeId]=a.registration)}),s},[M,g]);const P=m.useMemo(()=>$.filter(s=>{const t=me.find(r=>r.employeeId===s.id);return t?t.onDuty:Be.find(r=>r.employeeId===s.id)?.onDuty??!0}),[$,Be,me]),Ms=s=>{H(t=>t.map(a=>a.date===f&&a.employeeId===s?{...a,onDuty:!a.onDuty}:a))},as=()=>{const s=ve.trim().toUpperCase();if(!s)return;let t=g.find(r=>r.registration.toUpperCase()===s);if(t||(t=g.find(r=>r.registration.toUpperCase().includes(s))),!t){l({title:"Aircraft Not Found",description:`Registration "${s}" not found in fleet. Add it first.`,variant:"destructive"});return}if(D.find(r=>r.date===f&&r.aircraftId===t.id)){l({title:"Already Added",description:`${s} is already in today's work requirements.`,variant:"destructive"});return}const a={id:`wr-${t.id}-${f}-${Date.now()}`,date:f,aircraftId:t.id,b1Required:1,b2Required:1,catARequired:0,b1Hours:8,b2Hours:8,catAHours:8,b1TotalHours:8,b2TotalHours:8,catATotalHours:0,priority:"normal",specialSkillsRequired:[],boroscopeRequired:!1,engineRunRequired:!1};B(r=>[...r,a]),ie(""),l({title:"Aircraft Added",description:`${t.registration} (${t.type}) added to work requirements.`})},Es=s=>{const t=D.find(a=>a.id===s);B(a=>a.filter(r=>r.id!==s)),t&&L(a=>a.filter(r=>!(r.aircraftId===t.aircraftId&&r.date===f)))},Me=(s,t,a)=>{B(r=>r.map(n=>{if(n.date!==f||n.aircraftId!==s)return n;const x=Math.max(0,isNaN(a)?0:a),h={...n,[t]:x};return t==="b1TotalHours"?h.b1Required=Qe(x):t==="b2TotalHours"?h.b2Required=Qe(x):t==="catATotalHours"&&(h.catARequired=Qe(x)),h}))},$s=(s,t)=>{B(a=>a.map(r=>r.id===s?{...r,priority:t}:r))},Hs=(s,t)=>{B(a=>a.map(r=>{if(r.id!==s)return r;const n=r.specialSkillsRequired||[],x=n.includes(t);return{...r,specialSkillsRequired:x?n.filter(h=>h!==t):[...n,t]}}))},Ds=s=>{B(t=>t.map(a=>a.id===s?{...a,boroscopeRequired:!a.boroscopeRequired}:a))},Ps=s=>{B(t=>t.map(a=>a.id===s?{...a,engineRunRequired:!a.engineRunRequired}:a))},se=(s,t,a)=>{if(s.role==="PM"||s.role==="PS")return!1;if(a==="Cat A/Helper")return!0;const r=s.skills.find(n=>n.aircraftType===t.type);return!(!r||!r.license||a==="B1"&&r.license!=="B1"&&r.license!=="B1/2"||a==="B2"&&r.license!=="B2"&&r.license!=="B1/2")},F=(s,t)=>s.certifications.some(a=>a.toLowerCase().includes(t.toLowerCase())),we=(s,t)=>t.filter(a=>F(s,a)).length,is=()=>{const s=[],t={},a=[...V].sort((r,n)=>Y[r.priority||"normal"].order-Y[n.priority||"normal"].order);for(const r of a){const n=g.find(o=>o.id===r.aircraftId);if(!n)continue;const x=M.filter(o=>o.aircraftId===r.aircraftId&&o.isManualOverride);x.forEach(o=>{t[o.employeeId]=(t[o.employeeId]||0)+1,s.push(o)});const h=x.filter(o=>o.role==="B1").length,te=x.filter(o=>o.role==="B2").length,W=x.filter(o=>o.role==="Cat A/Helper").length,b=Math.max(0,r.b1Required-h),i=Math.max(0,r.b2Required-te),c=Math.max(0,(r.catARequired||0)-W),_=o=>s.some(y=>y.employeeId===o&&y.aircraftId===n.id),j=r.specialSkillsRequired||[],ns=P.filter(o=>!_(o.id)&&se(o,n,"B1")).sort((o,y)=>{const xe=we(o,j),he=we(y,j);return xe!==he?he-xe:(t[o.id]||0)-(t[y.id]||0)});for(let o=0;o<b&&o<ns.length;o++){const y=ns[o];s.push({id:`assign-${y.id}-${n.id}-${f}-B1`,date:f,aircraftId:n.id,employeeId:y.id,role:"B1",isManualOverride:!1}),t[y.id]=(t[y.id]||0)+1}const ls=P.filter(o=>!_(o.id)&&se(o,n,"B2")).sort((o,y)=>{const xe=we(o,j),he=we(y,j);return xe!==he?he-xe:(t[o.id]||0)-(t[y.id]||0)});for(let o=0;o<i&&o<ls.length;o++){const y=ls[o];s.push({id:`assign-${y.id}-${n.id}-${f}-B2`,date:f,aircraftId:n.id,employeeId:y.id,role:"B2",isManualOverride:!1}),t[y.id]=(t[y.id]||0)+1}const ds=P.filter(o=>!_(o.id)).sort((o,y)=>(t[o.id]||0)-(t[y.id]||0));for(let o=0;o<c&&o<ds.length;o++){const y=ds[o];s.push({id:`assign-${y.id}-${n.id}-${f}-CatA`,date:f,aircraftId:n.id,employeeId:y.id,role:"Cat A/Helper",isManualOverride:!1}),t[y.id]=(t[y.id]||0)+1}}L(r=>[...r.filter(n=>n.date!==f),...s]),l({title:"Auto-Assignment Complete",description:`Assigned ${s.length} positions to aircraft.`})},Ee=(s,t,a)=>{if(M.find(h=>h.aircraftId===s&&h.employeeId===t&&h.role===a)){l({title:"Already Assigned",description:"This employee is already assigned to this aircraft.",variant:"destructive"});return}const r={id:`assign-${t}-${s}-${f}-${a}-manual`,date:f,aircraftId:s,employeeId:t,role:a,isManualOverride:!0};L(h=>[...h,r]);const n=d.find(h=>h.id===t),x=g.find(h=>h.id===s);l({title:"Assignment Added",description:`${n?.name} assigned to ${x?.registration} as ${a}`})},$e=s=>{L(t=>t.filter(a=>a.id!==s))},_s=()=>{if(!Ne.trim()){l({title:"Enter Registration",description:"Please enter an aircraft registration.",variant:"destructive"});return}if(g.find(t=>t.registration.toUpperCase()===Ne.trim().toUpperCase())){l({title:"Already Exists",description:"This registration already exists.",variant:"destructive"});return}const s={id:`ac-${Date.now()}`,registration:Ne.trim().toUpperCase(),type:ss,company:ts};G(t=>[...t,s]),Ze(!1),es(""),l({title:"Aircraft Added",description:`${s.registration} (${s.type}) added to fleet.`})},Os=()=>{ee&&(G(s=>s.filter(t=>t.id!==ee.id)),B(s=>s.filter(t=>t.aircraftId!==ee.id)),L(s=>s.filter(t=>t.aircraftId!==ee.id)),l({title:"Aircraft Removed",description:`${ee.registration} removed from fleet.`}),Ae(null))},E=(()=>{let s=0,t=0,a=0,r=0;return V.forEach(n=>{const x=n.b1Required+n.b2Required+(n.catARequired||0),h=M.filter(i=>i.aircraftId===n.aircraftId).length;s+=x,t+=h,h<x&&(a+=x-h);const te=M.filter(i=>i.aircraftId===n.aircraftId&&i.role==="B1").length,W=M.filter(i=>i.aircraftId===n.aircraftId&&i.role==="B2").length,b=M.filter(i=>i.aircraftId===n.aircraftId&&i.role==="Cat A/Helper").length;r+=te*(n.b1Hours||8)+W*(n.b2Hours||8)+b*(n.catAHours||8)}),{totalRequired:s,totalAssigned:t,unfilled:a,onDuty:P.length,totalHours:r}})(),Ls=()=>{const s=`
      <!DOCTYPE html><html><head><title>Daily Assignments - ${ne(C,"MMMM d, yyyy")}</title>
      <style>body{font-family:Arial,sans-serif;padding:20px}h1{font-size:24px}h2{font-size:14px;color:#666}.aircraft{border:1px solid #ddd;margin-bottom:15px;padding:15px;border-radius:8px}.aircraft-header{font-size:18px;font-weight:bold}.role-section{margin:10px 0}.role-title{font-weight:bold;font-size:12px;color:#444}.employee{padding:4px 8px;background:#f5f5f5;margin:3px 0;border-radius:4px;font-size:13px}.skills{font-size:11px;color:#666;margin-top:5px}.hours{font-size:10px;color:#888}</style></head>
      <body><h1>AeroStaff - Daily Assignments</h1><h2>${ne(C,"EEEE, MMMM d, yyyy")}</h2>
      ${V.map(a=>{const r=g.find(b=>b.id===a.aircraftId);if(!r)return"";const n=M.filter(b=>b.aircraftId===a.aircraftId),x=n.filter(b=>b.role==="B1"),h=n.filter(b=>b.role==="B2"),te=n.filter(b=>b.role==="Cat A/Helper"),W=(a.specialSkillsRequired||[]).map(b=>q[b].label).join(", ");return`<div class="aircraft"><div class="aircraft-header">${r.registration} (${r.type}) - ${Y[a.priority].label}</div>
          ${W?`<div class="skills">Required: ${W}</div>`:""}
          <div class="role-section"><div class="role-title">B1 (${x.length}/${a.b1Required}) <span class="hours">${a.b1Hours||8}h each</span></div>${x.map(b=>{const i=d.find(c=>c.id===b.employeeId);return`<div class="employee">${i?.name} (${i?.initials})</div>`}).join("")}</div>
          <div class="role-section"><div class="role-title">B2 (${h.length}/${a.b2Required}) <span class="hours">${a.b2Hours||8}h each</span></div>${h.map(b=>{const i=d.find(c=>c.id===b.employeeId);return`<div class="employee">${i?.name} (${i?.initials})</div>`}).join("")}</div>
          ${(a.catARequired||0)>0?`<div class="role-section"><div class="role-title">Cat A/Helper (${te.length}/${a.catARequired||0}) <span class="hours">${a.catAHours||8}h each</span></div>${te.map(b=>{const i=d.find(c=>c.id===b.employeeId);return`<div class="employee">${i?.name} (${i?.initials})</div>`}).join("")}</div>`:""}</div>`}).join("")}
      <div style="margin-top:20px;padding:15px;background:#f0f0f0;border-radius:8px"><strong>Summary:</strong> ${E.totalAssigned}/${E.totalRequired} positions filled | ${E.totalHours.toFixed(1)}h total | ${E.onDuty} employees on duty</div></body></html>`,t=window.open("","_blank");t&&(t.document.write(s),t.document.close(),t.print())},Fs=()=>M.map(s=>({assignment:s,emp:d.find(t=>t.id===s.employeeId),ac:g.find(t=>t.id===s.aircraftId)})).filter(s=>s.emp&&s.ac),zs=s=>V.filter(t=>{const a=M.filter(r=>r.aircraftId===t.aircraftId);return s==="B1"?a.filter(r=>r.role==="B1").length<t.b1Required:s==="B2"?a.filter(r=>r.role==="B2").length<t.b2Required:a.filter(r=>r.role==="Cat A/Helper").length<(t.catARequired||0)}),Us=()=>{if(!re||!ce)return;const s=M.find(n=>n.employeeId===re);s&&L(n=>n.filter(x=>x.id!==s.id));const t={id:`assign-${re}-${ce}-${f}-${ue}-quick`,date:f,aircraftId:ce,employeeId:re,role:ue,isManualOverride:!0};L(n=>[...n,t]),Ke(!1),Ye(""),Ge("");const a=d.find(n=>n.id===re),r=g.find(n=>n.id===ce);l({title:"Quick Reassignment Complete",description:`${a?.name} moved to ${r?.registration} as ${ue}`})},rs=s=>{const t=d.map(a=>({date:f,employeeId:a.id,onDuty:s}));H(a=>[...a.filter(r=>r.date!==f),...t])};return e.jsxs("div",{className:"p-6 lg:p-8 space-y-6","data-testid":"aerostaff-page",children:[e.jsxs("header",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-sky-500 to-blue-600 flex items-center justify-center shadow-lg",children:e.jsx(He,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold tracking-tight","data-testid":"text-app-title",children:"AeroStaff"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(lt,{className:"w-3 h-3"})," Local Storage",e.jsx("span",{children:"•"}),"Aircraft Maintenance Staffing"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-muted px-4 py-2 rounded-lg",children:[e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>S(mt(C)),"data-testid":"button-prev-day",children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"font-mono text-sm font-medium","data-testid":"text-selected-date",children:ne(C,"EEE, MMM d, yyyy")})]}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>S(js(C,1)),"data-testid":"button-next-day",children:e.jsx(Ys,{className:"h-4 w-4"})})]}),e.jsxs(A,{onClick:is,className:"bg-primary","data-testid":"button-auto-assign",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"})," Auto-Assign"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(z,{className:"bg-gradient-to-br from-sky-50 to-blue-50 dark:from-sky-950/30 dark:to-blue-950/30 border-sky-200","data-testid":"card-stat-on-duty",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-sky-600",children:"On Duty"}),e.jsx("p",{className:"text-3xl font-display font-bold text-sky-700",children:E.onDuty})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-sky-500/20 flex items-center justify-center",children:e.jsx(os,{className:"w-6 h-6 text-sky-500"})})]})})}),e.jsx(z,{className:"bg-gradient-to-br from-violet-50 to-purple-50 dark:from-violet-950/30 dark:to-purple-950/30 border-violet-200","data-testid":"card-stat-required",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-violet-600",children:"Positions Required"}),e.jsx("p",{className:"text-3xl font-display font-bold text-violet-700",children:E.totalRequired})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-violet-500/20 flex items-center justify-center",children:e.jsx(ps,{className:"w-6 h-6 text-violet-500"})})]})})}),e.jsx(z,{className:"bg-gradient-to-br from-emerald-50 to-green-50 dark:from-emerald-950/30 dark:to-green-950/30 border-emerald-200","data-testid":"card-stat-assigned",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-600",children:"Assigned"}),e.jsx("p",{className:"text-3xl font-display font-bold text-emerald-700",children:E.totalAssigned})]}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-emerald-500/20 flex items-center justify-center",children:e.jsx(hs,{className:"w-6 h-6 text-emerald-500"})})]})})}),e.jsx(z,{className:T("border",E.unfilled>0?"bg-gradient-to-br from-red-50 to-rose-50 dark:from-red-950/30 dark:to-rose-950/30 border-red-200":"bg-gradient-to-br from-slate-50 to-gray-50 dark:from-slate-950/30 dark:to-gray-950/30 border-slate-200"),"data-testid":"card-stat-unfilled",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:T("text-sm",E.unfilled>0?"text-red-600":"text-slate-600"),children:"Unfilled"}),e.jsx("p",{className:T("text-3xl font-display font-bold",E.unfilled>0?"text-red-700":"text-slate-700"),children:E.unfilled})]}),e.jsx("div",{className:T("w-12 h-12 rounded-full flex items-center justify-center",E.unfilled>0?"bg-red-500/20":"bg-slate-500/20"),children:e.jsx(us,{className:T("w-6 h-6",E.unfilled>0?"text-red-500":"text-slate-500")})})]})})})]}),E.unfilled>0&&e.jsxs(z,{className:"border-red-500/50 bg-red-50 dark:bg-red-950/20","data-testid":"card-unfilled-details",children:[e.jsx(le,{className:"pb-2",children:e.jsxs(de,{className:"text-sm font-medium text-red-600 flex items-center gap-2",children:[e.jsx(us,{className:"h-4 w-4"})," Unfilled Positions - Action Required"]})}),e.jsx(U,{children:e.jsx("div",{className:"space-y-2",children:V.map(s=>{const t=g.find(x=>x.id===s.aircraftId);if(!t)return null;const a=M.filter(x=>x.aircraftId===s.aircraftId),r=Math.max(0,s.b1Required-a.filter(x=>x.role==="B1").length),n=Math.max(0,s.b2Required-a.filter(x=>x.role==="B2").length);return r===0&&n===0?null:e.jsxs("div",{className:"flex items-center justify-between p-2 rounded bg-white/50 dark:bg-black/20 border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:`text-xs text-white ${Y[s.priority].color}`,children:Y[s.priority].label}),e.jsx("span",{className:"font-mono font-medium",children:t.registration}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:["(",t.type,")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[r>0&&e.jsxs(p,{variant:"destructive",className:"text-xs",children:["B1: ",r," missing"]}),n>0&&e.jsxs(p,{variant:"destructive",className:"text-xs",children:["B2: ",n," missing"]})]})]},s.id)})})})]}),e.jsxs(Zs,{value:be,onValueChange:ae,className:"space-y-4",children:[e.jsxs(et,{className:"grid grid-cols-5 w-full max-w-2xl",children:[e.jsxs(pe,{value:"assignments","data-testid":"tab-assignments",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Assignments"]}),e.jsxs(pe,{value:"duty","data-testid":"tab-duty",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Duty Status"]}),e.jsxs(pe,{value:"requirements","data-testid":"tab-requirements",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Work Req."]}),e.jsxs(pe,{value:"employees","data-testid":"tab-employees",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Employees"]}),e.jsxs(pe,{value:"aircraft","data-testid":"tab-aircraft",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Aircraft"]})]}),e.jsx(ge,{value:"assignments",className:"space-y-4",children:e.jsxs(z,{children:[e.jsxs(le,{className:"flex flex-row items-center justify-between",children:[e.jsxs(de,{className:"font-display",children:["Daily Assignments - ",ne(C,"MMMM d, yyyy")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Pe,{open:Te,onOpenChange:Ke,children:[e.jsx(ms,{asChild:!0,children:e.jsxs(A,{variant:"outline",size:"sm","data-testid":"button-quick-reassign",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Quick Reassign"]})}),e.jsxs(_e,{children:[e.jsx(Oe,{children:e.jsx(Le,{children:"Quick Reassign"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Move an employee to another aircraft."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Employee to reassign"}),e.jsxs(J,{value:re,onValueChange:Ye,children:[e.jsx(X,{children:e.jsx(Q,{placeholder:"Select employee"})}),e.jsx(K,{children:Fs().map(({assignment:s,emp:t,ac:a})=>e.jsxs(I,{value:t.id,children:[t?.name," (",t?.initials,") - ",a?.registration," [",s.role,"]"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"New role"}),e.jsxs(J,{value:ue,onValueChange:s=>Ss(s),children:[e.jsx(X,{children:e.jsx(Q,{})}),e.jsxs(K,{children:[e.jsx(I,{value:"B1",children:"B1"}),e.jsx(I,{value:"B2",children:"B2"}),e.jsx(I,{value:"Cat A/Helper",children:"Cat A/Helper"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Move to aircraft"}),e.jsxs(J,{value:ce,onValueChange:Ge,children:[e.jsx(X,{children:e.jsx(Q,{placeholder:"Select aircraft"})}),e.jsx(K,{children:zs(ue).map(s=>{const t=g.find(a=>a.id===s.aircraftId);return e.jsxs(I,{value:s.aircraftId,children:[t?.registration," (",t?.type,")"]},s.id)})})]})]})]}),e.jsxs(Fe,{children:[e.jsx(xs,{asChild:!0,children:e.jsx(A,{variant:"outline",children:"Cancel"})}),e.jsx(A,{onClick:Us,disabled:!re||!ce,children:"Reassign"})]})]})]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:Ls,"data-testid":"button-print",children:[e.jsx(st,{className:"h-4 w-4 mr-2"}),"Print / PDF"]}),e.jsxs(A,{variant:"outline",size:"sm",onClick:is,children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsx(U,{children:V.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground border-2 border-dashed rounded-lg",children:[e.jsx(De,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"font-medium",children:"No work requirements for this day."}),e.jsx("p",{className:"text-sm",children:"Add aircraft and requirements first."}),e.jsxs(A,{className:"mt-4",onClick:()=>ae("requirements"),children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Add Work Requirements"]})]}):e.jsx("div",{className:"space-y-6",children:[...V].sort((s,t)=>Y[s.priority].order-Y[t.priority].order).map(s=>{const t=g.find(i=>i.id===s.aircraftId);if(!t)return null;const a=M.filter(i=>i.aircraftId===s.aircraftId),r=a.filter(i=>i.role==="B1"),n=a.filter(i=>i.role==="B2"),x=a.filter(i=>i.role==="Cat A/Helper"),h=s.specialSkillsRequired||[],te=a.map(i=>d.find(c=>c.id===i.employeeId)).filter(Boolean),W=h.filter(i=>te.some(c=>c&&F(c,i))),b=h.filter(i=>!W.includes(i));return e.jsxs("div",{className:T("p-4 rounded-lg border",s.priority==="urgent"?"border-red-500/50 bg-red-50/50 dark:bg-red-950/20":s.priority==="high"?"border-orange-500/50 bg-orange-50/50":"bg-muted/30"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:T("w-10 h-10 rounded-lg flex items-center justify-center",s.priority==="urgent"?"bg-red-500/20":s.priority==="high"?"bg-orange-500/20":"bg-primary/20"),children:e.jsx(He,{className:T("w-5 h-5",s.priority==="urgent"?"text-red-500":s.priority==="high"?"text-orange-500":"text-primary")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-display font-semibold text-lg",children:t.registration}),e.jsx(p,{className:`text-xs text-white ${Y[s.priority].color}`,children:Y[s.priority].label})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.type," • ",t.company]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(p,{variant:r.length>=s.b1Required?"default":"destructive",className:"font-mono",children:["B1: ",r.length,"/",s.b1Required]}),e.jsxs(p,{variant:n.length>=s.b2Required?"default":"destructive",className:"font-mono",children:["B2: ",n.length,"/",s.b2Required]}),(s.catARequired||0)>0&&e.jsxs(p,{variant:x.length>=(s.catARequired||0)?"default":"destructive",className:"font-mono",children:["Cat A: ",x.length,"/",s.catARequired||0]}),s.boroscopeRequired&&e.jsx(p,{className:"bg-violet-500 text-white",children:"Boroscope"}),s.engineRunRequired&&e.jsx(p,{className:"bg-rose-500 text-white",children:"Engine Run"})]})]}),h.length>0&&e.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-muted/50 border",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Required Skills"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(i=>{const c=W.includes(i);return e.jsxs(p,{variant:c?"default":"destructive",className:T("text-xs",c&&q[i].color),children:[c?e.jsx(hs,{className:"w-3 h-3 mr-1"}):e.jsx(Ce,{className:"w-3 h-3 mr-1"}),q[i].label]},i)})}),b.length>0&&e.jsxs("p",{className:"text-xs text-destructive mt-2",children:["Missing: ",b.map(i=>q[i].label).join(", ")]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-sm text-blue-600",children:"B1 Mechanics"}),r.map(i=>{const c=d.find(j=>j.id===i.employeeId),_=c?h.filter(j=>F(c,j)):[];return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 dark:bg-blue-950/30 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(p,{className:"bg-blue-500",children:"B1"}),e.jsx("span",{className:"font-mono text-sm",children:c?.initials}),e.jsx("span",{className:"text-sm",children:c?.name}),_.length>0&&_.map(j=>e.jsx(p,{variant:"outline",className:"text-xs",children:q[j].label},j))]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>$e(i.id),children:e.jsx(Ce,{className:"w-4 h-4"})})]},i.id)}),r.length<s.b1Required&&e.jsxs(J,{onValueChange:i=>Ee(t.id,i,"B1"),children:[e.jsx(X,{className:"border-dashed",children:e.jsx(Q,{placeholder:"+ Add B1 Engineer"})}),e.jsx(K,{children:P.filter(i=>se(i,t,"B1")&&!r.some(c=>c.employeeId===i.id)).map(i=>e.jsxs(I,{value:i.id,children:[i.name," (",i.initials,") ",h.filter(c=>F(i,c)).length>0?`[${h.filter(c=>F(i,c)).map(c=>q[c].label).join(", ")}]`:""]},i.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-sm text-emerald-600",children:"B2 Avionics"}),n.map(i=>{const c=d.find(j=>j.id===i.employeeId),_=c?h.filter(j=>F(c,j)):[];return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-emerald-50 dark:bg-emerald-950/30 rounded border border-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(p,{className:"bg-emerald-500",children:"B2"}),e.jsx("span",{className:"font-mono text-sm",children:c?.initials}),e.jsx("span",{className:"text-sm",children:c?.name}),_.length>0&&_.map(j=>e.jsx(p,{variant:"outline",className:"text-xs",children:q[j].label},j))]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>$e(i.id),children:e.jsx(Ce,{className:"w-4 h-4"})})]},i.id)}),n.length<s.b2Required&&e.jsxs(J,{onValueChange:i=>Ee(t.id,i,"B2"),children:[e.jsx(X,{className:"border-dashed",children:e.jsx(Q,{placeholder:"+ Add B2 Engineer"})}),e.jsx(K,{children:P.filter(i=>se(i,t,"B2")&&!n.some(c=>c.employeeId===i.id)).map(i=>e.jsxs(I,{value:i.id,children:[i.name," (",i.initials,") ",h.filter(c=>F(i,c)).length>0?`[${h.filter(c=>F(i,c)).map(c=>q[c].label).join(", ")}]`:""]},i.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-medium text-sm text-amber-600",children:"Cat A / Helpers"}),x.map(i=>{const c=d.find(j=>j.id===i.employeeId),_=c?h.filter(j=>F(c,j)):[];return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-50 dark:bg-amber-950/30 rounded border border-amber-200",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(p,{className:"bg-amber-500",children:"Cat A"}),e.jsx("span",{className:"font-mono text-sm",children:c?.initials}),e.jsx("span",{className:"text-sm",children:c?.name}),_.length>0&&_.map(j=>e.jsx(p,{variant:"outline",className:"text-xs",children:q[j].label},j))]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>$e(i.id),children:e.jsx(Ce,{className:"w-4 h-4"})})]},i.id)}),x.length<(s.catARequired||0)&&e.jsxs(J,{onValueChange:i=>Ee(t.id,i,"Cat A/Helper"),children:[e.jsx(X,{className:"border-dashed",children:e.jsx(Q,{placeholder:"+ Add Cat A/Helper"})}),e.jsx(K,{children:P.filter(i=>!x.some(c=>c.employeeId===i.id)).map(i=>e.jsxs(I,{value:i.id,children:[i.name," (",i.initials,") ",h.filter(c=>F(i,c)).length>0?`[${h.filter(c=>F(i,c)).map(c=>q[c].label).join(", ")}]`:""]},i.id))})]}),(s.catARequired||0)===0&&e.jsx("div",{className:"text-xs text-muted-foreground italic p-2",children:"No Cat A/Helpers required. Add in Work Requirements tab."})]})]})]},s.id)})})})]})}),e.jsx(ge,{value:"duty",className:"space-y-4",children:e.jsxs(z,{children:[e.jsxs(le,{className:"flex flex-row items-center justify-between",children:[e.jsxs(de,{children:["Duty Status - ",ne(C,"MMMM d, yyyy")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{variant:"outline",size:"sm",onClick:()=>rs(!0),children:"All On Duty"}),e.jsx(A,{variant:"outline",size:"sm",onClick:()=>rs(!1),children:"All Off Duty"})]})]}),e.jsxs(U,{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Note: PM and PS roles are excluded from auto-assignment."}),e.jsxs(ze,{children:[e.jsx(Ue,{children:e.jsxs(oe,{children:[e.jsx(R,{children:"Employee"}),e.jsx(R,{children:"Initials"}),e.jsx(R,{children:"Role"}),e.jsx(R,{children:"Department"}),e.jsx(R,{children:"Shift"}),e.jsx(R,{className:"text-right",children:"On Duty"})]})}),e.jsx(qe,{children:d.map(s=>{const t=me.find(x=>x.employeeId===s.id),a=Be.find(x=>x.employeeId===s.id),r=t?.onDuty??a?.onDuty??!0,n=s.role==="PM"||s.role==="PS";return e.jsxs(oe,{className:T(!r&&"opacity-50",n&&"bg-muted/30"),children:[e.jsx(k,{className:"font-medium",children:s.name}),e.jsx(k,{className:"font-mono",children:s.initials}),e.jsx(k,{children:e.jsxs(p,{variant:n?"secondary":"outline",children:[s.role,n&&" (excluded)"]})}),e.jsx(k,{className:"text-muted-foreground text-sm",children:s.department}),e.jsx(k,{children:t?e.jsx(p,{variant:"secondary",className:"text-xs",children:t.shiftCode}):"-"}),e.jsx(k,{className:"text-right",children:e.jsx(ks,{checked:r,onCheckedChange:()=>Ms(s.id),disabled:n})})]},s.id)})})]})]})]})}),e.jsxs(ge,{value:"requirements",className:"space-y-4",children:[e.jsxs(z,{children:[e.jsx(le,{children:e.jsx(de,{children:"Add Aircraft to Work Requirements"})}),e.jsx(U,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(fe,{placeholder:"Enter aircraft registration (e.g., HB-JCC)",value:ve,onChange:s=>ie(s.target.value),onKeyDown:s=>s.key==="Enter"&&as(),className:"max-w-xs"}),e.jsxs(A,{onClick:as,children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Add Aircraft"]})]})})]}),e.jsxs(z,{children:[e.jsx(le,{children:e.jsxs(de,{children:["Work Requirements - ",ne(C,"MMMM d, yyyy")]})}),e.jsx(U,{children:V.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg",children:[e.jsx(De,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No work requirements added yet"})]}):e.jsx("div",{className:"space-y-4",children:V.map(s=>{const t=g.find(a=>a.id===s.aircraftId);return e.jsxs("div",{className:T("p-4 border rounded-lg",s.priority==="urgent"&&"border-red-500/50 bg-red-50/30",s.priority==="high"&&"border-orange-500/50 bg-orange-50/30"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-mono font-bold text-lg",children:t?.registration}),e.jsx(p,{variant:"outline",children:t?.type})]}),e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>Es(s.id),children:e.jsx(fs,{className:"w-4 h-4 text-destructive"})})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(O,{className:"text-xs",children:"Priority"}),e.jsxs(J,{value:s.priority,onValueChange:a=>$s(s.id,a),children:[e.jsx(X,{children:e.jsx(Q,{})}),e.jsxs(K,{children:[e.jsx(I,{value:"urgent",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),"Urgent"]})}),e.jsx(I,{value:"high",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-500"}),"High"]})}),e.jsx(I,{value:"normal",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Normal"]})}),e.jsx(I,{value:"low",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-500"}),"Low"]})})]})]})]}),e.jsxs("div",{children:[e.jsx(O,{className:"text-xs text-blue-600",children:"B1 Hours"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(fe,{type:"number",min:"0",step:"1",value:s.b1TotalHours??s.b1Required*8,onChange:a=>Me(s.aircraftId,"b1TotalHours",parseFloat(a.target.value)||0),className:"w-full",placeholder:"Total hours"}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[e.jsxs("span",{children:["= ",s.b1Required," person",s.b1Required!==1?"s":""]}),e.jsxs("span",{className:"text-blue-600 font-medium",children:[s.b1TotalHours??s.b1Required*8,"h"]})]})]})]}),e.jsxs("div",{children:[e.jsx(O,{className:"text-xs text-emerald-600",children:"B2 Hours"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(fe,{type:"number",min:"0",step:"1",value:s.b2TotalHours??s.b2Required*8,onChange:a=>Me(s.aircraftId,"b2TotalHours",parseFloat(a.target.value)||0),className:"w-full",placeholder:"Total hours"}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[e.jsxs("span",{children:["= ",s.b2Required," person",s.b2Required!==1?"s":""]}),e.jsxs("span",{className:"text-emerald-600 font-medium",children:[s.b2TotalHours??s.b2Required*8,"h"]})]})]})]}),e.jsxs("div",{children:[e.jsx(O,{className:"text-xs text-amber-600",children:"Cat A Hours"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(fe,{type:"number",min:"0",step:"1",value:s.catATotalHours??(s.catARequired||0)*8,onChange:a=>Me(s.aircraftId,"catATotalHours",parseFloat(a.target.value)||0),className:"w-full",placeholder:"Total hours"}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center justify-between",children:[e.jsxs("span",{children:["= ",s.catARequired||0," person",(s.catARequired||0)!==1?"s":""]}),e.jsxs("span",{className:"text-amber-600 font-medium",children:[s.catATotalHours??(s.catARequired||0)*8,"h"]})]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(O,{className:"text-xs",children:"Qualified Available"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(p,{variant:"secondary",className:"text-blue-600",children:["B1: ",t?P.filter(a=>se(a,t,"B1")).length:0]}),e.jsxs(p,{variant:"secondary",className:"text-emerald-600",children:["B2: ",t?P.filter(a=>se(a,t,"B2")).length:0]}),e.jsxs(p,{variant:"secondary",className:"text-amber-600",children:["Any: ",P.length]})]})]}),e.jsxs("div",{children:[e.jsx(O,{className:"text-xs mb-2 block",children:"Special Skills Required"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:It.map(a=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(We,{checked:(s.specialSkillsRequired||[]).includes(a),onCheckedChange:()=>Hs(s.id,a)}),e.jsx("span",{className:"text-sm",children:q[a].label})]},a))})]}),e.jsxs("div",{className:"flex gap-6 mt-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(We,{checked:s.boroscopeRequired||!1,onCheckedChange:()=>Ds(s.id)}),e.jsxs("span",{className:"text-sm font-medium flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-violet-500"}),"Boroscope Required"]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(We,{checked:s.engineRunRequired||!1,onCheckedChange:()=>Ps(s.id)}),e.jsxs("span",{className:"text-sm font-medium flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-rose-500"}),"Engine Run Required"]})]})]})]},s.id)})})})]})]}),e.jsx(ge,{value:"employees",className:"space-y-4",children:e.jsxs(z,{children:[e.jsx(le,{children:e.jsxs(de,{children:["Employees (",d.length,")"]})}),e.jsx(U,{children:e.jsxs(ze,{children:[e.jsx(Ue,{children:e.jsxs(oe,{children:[e.jsx(R,{children:"Name"}),e.jsx(R,{children:"Initials"}),e.jsx(R,{children:"Role"}),e.jsx(R,{children:"Department"}),e.jsx(R,{children:"Qualifications"}),e.jsx(R,{children:"Certifications"})]})}),e.jsx(qe,{children:d.map(s=>e.jsxs(oe,{className:T((s.role==="PM"||s.role==="PS")&&"bg-muted/30"),children:[e.jsx(k,{className:"font-medium",children:s.name}),e.jsx(k,{className:"font-mono",children:s.initials}),e.jsx(k,{children:e.jsx(p,{variant:s.role==="PM"||s.role==="PS"?"secondary":"outline",children:s.role})}),e.jsx(k,{className:"text-muted-foreground text-sm",children:s.department}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[s.skills.filter(t=>t.license).slice(0,6).map((t,a)=>e.jsxs(p,{variant:"secondary",className:T("text-xs",t.license==="B1"&&"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",t.license==="B2"&&"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/50 dark:text-emerald-300",t.license==="B1/2"&&"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"),children:[e.jsx("span",{className:"font-bold mr-1",children:t.aircraftType}),e.jsx("span",{className:"opacity-70",children:"|"}),e.jsx("span",{className:"ml-1",children:t.license})]},a)),s.skills.filter(t=>t.license).length>6&&e.jsxs(p,{variant:"secondary",className:"text-xs",children:["+",s.skills.filter(t=>t.license).length-6]}),s.skills.filter(t=>t.license).length===0&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})]})}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.certifications.slice(0,3).map((t,a)=>e.jsx(p,{variant:"outline",className:"text-xs",children:t},a)),s.certifications.length>3&&e.jsxs(p,{variant:"secondary",className:"text-xs",children:["+",s.certifications.length-3]}),s.certifications.length===0&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})]})})]},s.id))})]})})]})}),e.jsxs(ge,{value:"aircraft",className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs(le,{className:"flex flex-row items-center justify-between",children:[e.jsxs(de,{children:["Aircraft Fleet (",g.length,")"]}),e.jsxs(Pe,{open:Is,onOpenChange:Ze,children:[e.jsx(ms,{asChild:!0,children:e.jsxs(A,{"data-testid":"button-add-aircraft",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Add Aircraft"]})}),e.jsxs(_e,{children:[e.jsx(Oe,{children:e.jsx(Le,{children:"Add New Aircraft"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Registration"}),e.jsx(fe,{placeholder:"e.g., HB-JCC",value:Ne,onChange:s=>es(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Aircraft Type"}),e.jsxs(J,{value:ss,onValueChange:Ts,children:[e.jsx(X,{children:e.jsx(Q,{})}),e.jsx(K,{children:Gs.map(s=>e.jsx(I,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Company"}),e.jsxs(J,{value:ts,onValueChange:Bs,children:[e.jsx(X,{children:e.jsx(Q,{})}),e.jsxs(K,{children:[e.jsx(I,{value:"LX",children:"LX (Swiss)"}),e.jsx(I,{value:"WK",children:"WK (Edelweiss)"})]})]})]})]}),e.jsxs(Fe,{children:[e.jsx(xs,{asChild:!0,children:e.jsx(A,{variant:"outline",children:"Cancel"})}),e.jsx(A,{onClick:_s,children:"Add Aircraft"})]})]})]})]}),e.jsx(U,{children:e.jsxs(ze,{children:[e.jsx(Ue,{children:e.jsxs(oe,{children:[e.jsx(R,{children:"Registration"}),e.jsx(R,{children:"Type"}),e.jsx(R,{children:"Company"}),e.jsx(R,{children:"Qualified B1"}),e.jsx(R,{children:"Qualified B2"}),e.jsx(R,{className:"text-right",children:"Actions"})]})}),e.jsx(qe,{children:g.map(s=>e.jsxs(oe,{children:[e.jsx(k,{className:"font-mono font-bold",children:s.registration}),e.jsx(k,{children:e.jsx(p,{variant:"outline",children:s.type})}),e.jsx(k,{children:s.company}),e.jsx(k,{children:e.jsxs(p,{variant:"secondary",children:[P.filter(t=>se(t,s,"B1")).length," available"]})}),e.jsx(k,{children:e.jsxs(p,{variant:"secondary",children:[P.filter(t=>se(t,s,"B2")).length," available"]})}),e.jsx(k,{className:"text-right",children:e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>Ae(s),className:"text-destructive hover:text-destructive",children:e.jsx(fs,{className:"w-4 h-4"})})})]},s.id))})]})})]}),e.jsx(Pe,{open:!!ee,onOpenChange:()=>Ae(null),children:e.jsxs(_e,{children:[e.jsx(Oe,{children:e.jsx(Le,{children:"Remove Aircraft"})}),e.jsxs("p",{className:"py-4",children:["Are you sure you want to remove ",e.jsx("strong",{children:ee?.registration})," (",ee?.type,") from the fleet? This will also remove all associated work requirements and assignments."]}),e.jsxs(Fe,{children:[e.jsx(A,{variant:"outline",onClick:()=>Ae(null),children:"Cancel"}),e.jsx(A,{variant:"destructive",onClick:Os,children:"Remove Aircraft"})]})]})})]})]})]})}export{Ot as AeroStaffPage};
